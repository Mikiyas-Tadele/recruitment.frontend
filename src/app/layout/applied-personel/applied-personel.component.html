<div class="spaceholder">

</div>
<p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle" width="425"></p-confirmDialog>
<p-toast [style]="{marginTop: '100px'}"></p-toast>
<div class="filterFields">
<p-panel header="Expand this pannel to Filter applicants" [toggleable]="true" toggler="header" [collapsed] ="true">
	<ng-template>
		<button pButton (click)="onClick($event, menu)">
        </button>
	</ng-template>

<form role="form" [formGroup]="filterForm" (ngSubmit)="search(filterForm)"  class="p-5">
  
    <fieldset class="form-group">
      <table class=" table table-borderless table-responsive">
        <tr>
          <td>
            <label for="age">Age: </label>
          </td>
          <td>
            <select  name="agecriteria" formControlName="ageCriteria" >
              <option  value="">All</option>
              <option  value="greaterthan">Greater Than or Equal To</option>
              <option value="lessthan">Less Than or Equal To</option>
            </select>
            </td>
            <td>
          <input type="number" formControlName="age" name="age" />
          </td>
          <td>
            <label for="cgpa">CGPA: </label>
          </td>
          <td><select  name="cgpacriteria" formControlName="cgpaCriteria" >
            <option  value="">All</option>
            <option  value="greaterthan">Greater Than or Equal To</option>
            <option value="lessthan">Less Than or Equal To</option>
          </select>
        </td>
        <td>
        <input type="number" formControlName="cgpa"  name="cgpa" /></td>
        </tr>
        <tr>
          <td>
            <label for="we"> WorkExperience: </label>
          </td>
          <td>
            <select  name="weCriteria" formControlName="workExperienceCriteria" >
              <option  value="">All</option>
              <option  value="greaterthan">Greater Than or Equal To</option>
              <option value="lessthan">Less Than or Equal To</option>
            </select>
            </td>
            <td>
          <input type="number" formControlName="workExperience" name="we" />
          </td>
          <td>
            <label for="gy">Graduation Year: </label>
          </td>
          <td><select  name="graduationYearCriteria" formControlName="graduationYearCriteria" >
            <option  value="">All</option>
            <option  value="greaterthan">Greater Than or Equal To</option>
            <option value="lessthan">Less Than or Equal To</option>
          </select>
        </td>
        <td>
        <input type="number" formControlName="graduationYear"  name="gy" /></td>
        </tr>
        <tr>
          <td><label for="gender">Gender:</label></td>
          <td> <select  name="gender" formControlName="gender">
            <option  value="">All</option>
            <option  value="Male">Male</option>
            <option value="Female">Female</option>
          </select>
          </td>
          <td>
            <label for="qualification">Qualification: </label>
          </td>
          <td>
            <select  name="qualification" formControlName="qualification" >
              <option  value="">All</option>
              <option *ngFor="let d of qualifications" [ngValue]="d.value">{{d.label}}</option>
            </select>
            </td>
        </tr>
      </table>
      <div style="float:right;">
        <button type="submit" class="btn btn-primary">Search</button>&nbsp;&nbsp;
        <button type="button" class="btn btn-success"  (click)="reset()">Reset</button>
        </div>
    </fieldset>   
</form>
</p-panel>
</div>
<br />
<p-table [value]="appliedPersonels" [responsive]="true" [autoLayout]="true"  sortMode="single" (onSort)="onSort()" [(selection)]="selectedApplicants">
  <ng-template pTemplate="caption">
    <div class="ui-helper-clearfix" style="text-align: left">
      <button type="button" pButton icon="pi pi-file-excel" iconPos="left" label="Export to EXCEL" (click)="exportExcel()" style="margin-right: 0.5em;" class="ui-button-success"></button>
      <button type="button" pButton icon="pi pi-arrow-right" iconPos="left" label="Move to Next Stage" (click)="moveToWE()" style="margin-right: 0.5em;" class="ui-button-success"></button>
  </div>
    <h5>Development Bank of Ethiopia<br>
      Human Resource Management Directorate<br>
      Applicants profile Summary for the Position of {{vacancyName}}
     </h5>
  </ng-template>
  <ng-template pTemplate="header">
      <tr>
          <th style="width: 3em" rowspan="2">Select</th>
          <th rowspan="2"  [pSortableColumn]="'fullName'">Name
            <p-sortIcon [field]="'fullName'" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
          </th>
          <th rowspan="2">Email</th>
          <th rowspan="2" [pSortableColumn]="'age'">Age
            <p-sortIcon [field]="'age'" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>

          </th>
          <th rowspan="2">Gender</th>
          <th rowspan="2">Disability</th>
          <th rowspan="2">Mobile</th>
          <th rowspan="2">Fixed</th>
          <th rowspan="2">CV</th>
          <th rowspan="2">Document</th>
          <th rowspan="2">Application Letter</th>
          <th colspan="5">Educational Background</th>
          <th colspan="5">Work Experience</th>
      </tr>
      <tr>
          <th>Field of Education</th>
          <th>Qualification</th>
          <th>University</th>
          <th [pSortableColumn]="'yearOfGraduation'">Year Of Graduation
            <p-sortIcon [field]="'yearOfGraduation'" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
          </th>
          <th [pSortableColumn]="'cgpa'">CGPA
            <p-sortIcon [field]="'cgpa'" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
          </th>
          <th>Organization</th>
          <th>Position</th>
          <th>Salary</th>
          <th>Duration</th>
          <th [pSortableColumn]="'totalExperience'">Total Experience In Years
            <p-sortIcon [field]="'totalExperience'" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
          </th>
      </tr>
  </ng-template>
  <ng-template pTemplate="body" let-appliedPersonel let-rowIndex="rowIndex">
      <tr>
          <td><p-tableCheckbox *ngIf="appliedPersonel.userId!=null" [value]="appliedPersonel"></p-tableCheckbox></td>
          <td *ngIf="rowGroupFullName[appliedPersonel.fullName].index === rowIndex" [attr.rowspan]="rowGroupFullName[appliedPersonel.fullName].size">{{appliedPersonel.fullName}}</td>
          <td *ngIf="rowGroupEmail[appliedPersonel.email].index === rowIndex" [attr.rowspan]="rowGroupEmail[appliedPersonel.email].size">{{appliedPersonel.email}}</td>
          <td>{{appliedPersonel.age}}</td>
          <td>{{appliedPersonel.gender}}</td>
          <td>{{appliedPersonel.disability}}</td>
          <td>{{appliedPersonel.mobilePhone1}}</td>
          <td>{{appliedPersonel.fixedLinePhone}}</td>
          <td><button  *ngIf="appliedPersonel.userId!=null" pButton icon="pi pi-download" class="ui-button-success" (click)="downloadCV(appliedPersonel,1)" pTooltip="download cv" tooltipPosition="top"></button></td>
          <td><button  *ngIf="appliedPersonel.userId!=null" pButton icon="pi pi-download" class="ui-button-success" (click)="downloadQualificationDocument(appliedPersonel,2)" pTooltip="download qualification document" tooltipPosition="top"></button></td>
          <td><button  *ngIf="appliedPersonel.applicationLetter!=null" pButton  class="ui-button-secondary" (click)="displayAL(appliedPersonel)">Application Letter</button></td>
          <td>{{appliedPersonel.fieldOfEducation}}</td>
          <td>{{appliedPersonel.qualificationDesc}}</td>
          <td>{{appliedPersonel.university}}</td>
          <td>{{appliedPersonel.yearOfGraduation}}</td>
          <td>{{appliedPersonel.cgpa}}</td>
          <td>{{appliedPersonel.organization}}</td>
          <td>{{appliedPersonel.position}}</td>
          <td>{{appliedPersonel.salary}}</td>
          <td>{{appliedPersonel.startDate | date :'dd/MM/yyyy'}} - {{appliedPersonel.endDate | date :'dd/MM/yyyy'}}</td>
          <td *ngIf="rowGroupTotal[appliedPersonel.totalExperience].index === rowIndex" [attr.rowspan]="rowGroupTotal[appliedPersonel.totalExperience].size">{{appliedPersonel.totalExperience}}</td>
      </tr>
  </ng-template>
  <ng-template pTemplate="footer">
  </ng-template>
</p-table>

<p-dialog header="Application Letter" [(visible)]="display" [modal]="true" [responsive]="true" [style]="{width: '350px', minWidth: '200px'}" [minY]="70" 
        [maximizable]="true" [baseZIndex]="10000">
        <p-editor [(ngModel)]="letter" [style]="{'height':'200px'}" [readonly]="true" name ="description"></p-editor>
        <p-footer>
        </p-footer>
</p-dialog>
